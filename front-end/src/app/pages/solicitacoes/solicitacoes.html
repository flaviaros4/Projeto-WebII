<div class="container">
  <div class="header">
    <h1>Solicitações</h1>
  
 <div class="filtros">
<button mat-raised-button [matMenuTriggerFor]="filtroMenu" style="background-color: #1976d2;">
  <mat-icon>filter_list</mat-icon> Filtrar por
</button>


<mat-menu #filtroMenu="matMenu" class="menu-filtro" >
  <div class="filtro-data" >
    <button mat-menu-item value="TODAS" (click)="carregarTodasSolicitacoes() ; mostrarFiltroPeriodo = false"> TODAS </button>
    <button mat-menu-item value="HOJE" (click)="filtrarDataHoje() ; mostrarFiltroPeriodo = false"> HOJE </button>
    <button mat-menu-item value="POR_PERIODO" (click)="filtrarPorIntervalo() ; mostrarFiltroPeriodo = true"> POR PERIODO</button>
  </div>
</mat-menu>

 <div class="filtro-periodo" *ngIf="mostrarFiltroPeriodo">
      <mat-form-field appearance="fill" style="padding: 10px;" >
        <mat-label>Data Inicial</mat-label>
        <input matInput [matDatepicker]="picker1" [(ngModel)]="dataInicioFiltro">
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Data Final</mat-label>
        <input matInput [matDatepicker]="picker2" [(ngModel)]="dataFimFiltro">
        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
      </mat-form-field>

      <button mat-raised-button color="primary" (click)="filtrarPeriodo()"> 
      Confirmar
      </button>
      
    </div>
</div>
  </div>


   
   <table mat-table [dataSource]="solicitacoes" class="mat-elevation-z3 tabela">

    <ng-container matColumnDef="dataHora">
      <th mat-header-cell *matHeaderCellDef> Data/Hora </th>
      <td mat-cell *matCellDef="let s"> {{s.dataHora | date : 'short' : '' : 'pt-BR'}}  </td>
    </ng-container>


    <ng-container matColumnDef="cliente">
      <th mat-header-cell *matHeaderCellDef> Cliente </th>
      <td mat-cell *matCellDef="let s"> {{ s.cliente }} </td>
    </ng-container>


    <ng-container matColumnDef="equipamento">
      <th mat-header-cell *matHeaderCellDef> Equipamento </th>
      <td mat-cell *matCellDef="let s">
        {{ s.equipamento | slice:0:30 }}{{ s.equipamento.length > 30 ? '...' : '' }}
      </td>
    </ng-container>

    <ng-container matColumnDef="estado">
      <th mat-header-cell *matHeaderCellDef> Estado </th>
      <td mat-cell *matCellDef="let s"> {{ s.estado }} </td>
    </ng-container>

    <ng-container matColumnDef="acoes">
      <th mat-header-cell *matHeaderCellDef> Ações </th>
      <td mat-cell *matCellDef="let element">
      
       
        <ng-container [ngSwitch]="element.estado">

          

          <ng-container *ngSwitchCase="'ABERTA'">
            <button mat-button color="warn" title="Efetuar Orçamento" (click)="efetuarOrcamento(element)" style="background-color: rgba(128, 128, 128, 0.815);" >
              Efetuar Orçamento
            </button>
          </ng-container>


          <ng-container *ngSwitchCase="'APROVADA'">
            <button mat-button color="warn" title="Efetuar Manutenção" (click)="efetuarManutencao(element)" style="background-color: rgb(170, 170, 67);" >
              Efetuar Manutenção
            </button>
          </ng-container>
           <ng-container *ngSwitchCase="'REDIRECIONADA'">
            <button mat-button color="warn" title="Efetuar Manutenção" (click)="efetuarManutencao(element)" style="background-color: rgba(172, 96, 172, 0.74)">
              Efetuar Manutenção
            </button>
          </ng-container>

          <ng-container *ngSwitchCase="'PAGA'">
             <button mat-button color="primary" title="Finalizar Solicitação" class="pagar-btn" (click)="finalizarSolicitacao(element)" style="background-color: rgba(255, 166, 0, 0.603); ">
            Finalizar Solicitação
          </button>
          </ng-container>

      
          <ng-container *ngSwitchDefault>

          </ng-container>

        </ng-container>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;" [ngClass]="defineCorEstado(row.estado)"></tr>
  </table>
</div>
